<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=380">
  <title>Atlas UX</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <!-- ============================================ -->
  <!-- HEADER                                       -->
  <!-- ============================================ -->
  <header id="header">
    <div class="header-left">
      <div class="logo">
        <svg width="20" height="20" viewBox="0 0 48 48">
          <circle cx="24" cy="24" r="24" fill="#0f172a" stroke="#06b6d4" stroke-width="1.5"/>
          <path d="M24 9L13 39h5.5l2.2-6h6.6l2.2 6H35L24 9zm0 9.6l3.8 10.4h-7.6L24 18.6z" fill="#06b6d4"/>
        </svg>
      </div>
      <span class="header-title">Atlas UX</span>
    </div>
    <div class="header-right">
      <span class="connection-status" id="connectionDot" title="Disconnected"></span>
      <button class="icon-btn" id="settingsBtn" title="Settings">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
        </svg>
      </button>
    </div>
  </header>

  <!-- ============================================ -->
  <!-- TOAST                                        -->
  <!-- ============================================ -->
  <div id="toast" class="toast hidden"></div>

  <!-- ============================================ -->
  <!-- LOGIN VIEW                                   -->
  <!-- ============================================ -->
  <section id="loginView" class="view">
    <div class="login-card">
      <h2>Connect to Atlas</h2>
      <p class="login-subtitle">Enter your platform credentials to get started.</p>

      <div class="field">
        <label for="apiUrl">API URL</label>
        <input type="url" id="apiUrl" placeholder="https://atlas-ux.onrender.com/v1" value="https://atlas-ux.onrender.com/v1">
      </div>
      <div class="field">
        <label for="authToken">Auth Token</label>
        <input type="password" id="authToken" placeholder="Bearer token or API key">
      </div>
      <div class="field">
        <label for="tenantId">Tenant ID</label>
        <input type="text" id="tenantId" placeholder="your-tenant-uuid">
      </div>

      <button class="btn-primary" id="connectBtn">
        <span id="connectBtnText">Connect</span>
        <span id="connectSpinner" class="spinner hidden"></span>
      </button>

      <p class="login-error hidden" id="loginError"></p>
    </div>
  </section>

  <!-- ============================================ -->
  <!-- MAIN (CONNECTED) VIEW                        -->
  <!-- ============================================ -->
  <section id="mainView" class="view hidden">

    <!-- STATS BAR -->
    <div class="stats-bar">
      <div class="stat-card">
        <span class="stat-value" id="statJobs">--</span>
        <span class="stat-label">Active Jobs</span>
      </div>
      <div class="stat-card">
        <span class="stat-value" id="statDecisions">--</span>
        <span class="stat-label">Decisions</span>
      </div>
      <div class="stat-card">
        <span class="stat-value" id="statAgents">--</span>
        <span class="stat-label">Agents</span>
      </div>
    </div>

    <!-- AGENT CHAT -->
    <div class="section-card">
      <div class="section-header">
        <h3>Agent Chat</h3>
      </div>
      <div class="agent-pills" id="agentPills">
        <button class="agent-pill active" data-agent="atlas">Atlas</button>
        <button class="agent-pill" data-agent="binky">Binky</button>
        <button class="agent-pill" data-agent="cheryl">Cheryl</button>
        <button class="agent-pill" data-agent="sunday">Sunday</button>
      </div>
      <div class="chat-messages" id="chatMessages">
        <div class="chat-empty">Select an agent and send a message.</div>
      </div>
      <div class="chat-input-row">
        <input type="text" id="chatInput" placeholder="Message Atlas..." maxlength="500">
        <button class="btn-send" id="sendBtn" title="Send">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/>
          </svg>
        </button>
      </div>
    </div>

    <!-- ACTIVITY FEED -->
    <div class="section-card">
      <div class="section-header">
        <h3>Recent Activity</h3>
        <button class="text-btn" id="refreshActivityBtn" title="Refresh">
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
          </svg>
        </button>
      </div>
      <div id="activityFeed" class="activity-feed">
        <div class="activity-empty">No recent activity.</div>
      </div>
    </div>

    <!-- QUICK ACTIONS -->
    <div class="quick-actions">
      <button class="btn-primary btn-sm" id="newJobBtn">New Job</button>
      <button class="btn-secondary btn-sm" id="openDashboardBtn">Open Dashboard</button>
      <button class="btn-ghost btn-sm" id="logoutBtn">Logout</button>
    </div>
  </section>

  <!-- ============================================ -->
  <!-- NEW JOB MODAL                                -->
  <!-- ============================================ -->
  <div id="jobModal" class="modal-overlay hidden">
    <div class="modal">
      <div class="modal-header">
        <h3>Create Job</h3>
        <button class="icon-btn" id="closeModalBtn">&times;</button>
      </div>
      <div class="field">
        <label for="jobType">Type</label>
        <select id="jobType">
          <option value="CONTENT_CREATE">Content Create</option>
          <option value="RESEARCH">Research</option>
          <option value="EMAIL_SEND">Email Send</option>
          <option value="SOCIAL_POST">Social Post</option>
          <option value="ANALYSIS">Analysis</option>
        </select>
      </div>
      <div class="field">
        <label for="jobDesc">Description</label>
        <textarea id="jobDesc" rows="3" placeholder="Describe the job..."></textarea>
      </div>
      <button class="btn-primary" id="submitJobBtn">Create Job</button>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- FOOTER                                       -->
  <!-- ============================================ -->
  <footer id="footer">
    <span class="footer-text">Atlas UX v1.0.0</span>
  </footer>

  <script src="popup.js"></script>
</body>
</html>
